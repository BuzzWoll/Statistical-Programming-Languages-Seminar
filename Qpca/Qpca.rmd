---
title: "Qpca"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
load("../Qdataprep/data.RData")
# Format data into POSIXct 
train[,1] = as.POSIXct(train[,1])
end_date = as.POSIXct("2015-01-01")
# Only use data until december 2014 to select the model
x = train[train$date < end_date,]
y = x$`S&P500`

pca_data = prcomp(x[,-1],
                  center = T,
                  scale. = T)

summary(pca_data)
plot(pca_data, type = "l")

# Model selection

#gets the first PCA
z = as.matrix(pca_data$rotation[,1:3])
# get rid of the data column
dat = as.matrix(x[,-1])

diff_index1 = dat %*% z
a = lm(y ~ diff_index1[,1])
summary(a)
BIC()
BIC()

diff_index1[,1]
```


```{r}
pca_data = prcomp(subset(train[,-1],),
                  center = T,
                  scale. = T)

predict.prcomp()
```

